/**
 * 438. æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯ (Find All Anagrams in a String)
 * https://leetcode.cn/problems/find-all-anagrams-in-a-string/
 *
 * é¢˜ç›®æè¿°:
 * ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸² s å’Œ pï¼Œæ‰¾åˆ° s ä¸­æ‰€æœ‰ p çš„ å¼‚ä½è¯ çš„å­ä¸²ï¼Œè¿”å›è¿™äº›å­ä¸²çš„èµ·å§‹ç´¢å¼•ã€‚ä¸è€ƒè™‘ç­”æ¡ˆè¾“å‡ºçš„é¡ºåºã€‚
 * å¼‚ä½è¯ æŒ‡ç”±ç›¸åŒå­—æ¯é‡æ’åˆ—å½¢æˆçš„å­—ç¬¦ä¸²ï¼ˆåŒ…æ‹¬ç›¸åŒçš„å­—ç¬¦ä¸²ï¼‰ã€‚
 * 
 * ç¤ºä¾‹ 1:
 * è¾“å…¥: s = "cbaebabacd", p = "abc"
 * è¾“å‡º: [0,6]
 * è§£é‡Š:
 * èµ·å§‹ç´¢å¼•ç­‰äº 0 çš„å­ä¸²æ˜¯ "cba", å®ƒæ˜¯ "abc" çš„å¼‚ä½è¯ã€‚
 * èµ·å§‹ç´¢å¼•ç­‰äº 6 çš„å­ä¸²æ˜¯ "bac", å®ƒæ˜¯ "abc" çš„å¼‚ä½è¯ã€‚
 * 
 * ç¤ºä¾‹ 2:
 * è¾“å…¥: s = "abab", p = "ab"
 * è¾“å‡º: [0,1,2]
 * è§£é‡Š:
 * èµ·å§‹ç´¢å¼•ç­‰äº 0 çš„å­ä¸²æ˜¯ "ab", å®ƒæ˜¯ "ab" çš„å¼‚ä½è¯ã€‚
 * èµ·å§‹ç´¢å¼•ç­‰äº 1 çš„å­ä¸²æ˜¯ "ba", å®ƒæ˜¯ "ab" çš„å¼‚ä½è¯ã€‚
 * èµ·å§‹ç´¢å¼•ç­‰äº 2 çš„å­ä¸²æ˜¯ "ab", å®ƒæ˜¯ "ab" çš„å¼‚ä½è¯ã€‚
 * 
 * æç¤º:
 * 1 <= s.length, p.length <= 3 * 104
 * s å’Œ p ä»…åŒ…å«å°å†™å­—æ¯
 */

#include <iostream>
#include <vector>
#include <string>

using namespace std;

class Solution {
public:
    vector<int> findAnagrams(string s, string p) {

        vector<int> ret;
        vector<int> cnt(26, 0);

        for (auto &tmp : p) {
            cnt[tmp-'a']++;
        }

        int seed = p.size();
        int left=0, right = 0;
        while (right < s.size()) {
            
            // è¿›çª—å£ï¼šå¦‚æœæ˜¯ p ä¸­éœ€è¦çš„å­—ç¬¦ (cnt > 0)ï¼Œåˆ™æœ‰æ•ˆå­—ç¬¦æ•° seed å‡ 1
            if (cnt[s[right]-'a']-- > 0) {
                --seed;
            }
            ++right;

            // å¦‚æœæœ‰æ•ˆå­—ç¬¦æ•° seed ä¸º 0ï¼Œè¯´æ˜å½“å‰çª—å£æ˜¯ p çš„å¼‚ä½è¯
            if (seed == 0) ret.emplace_back(left);
            
            // å‡ºçª—å£ï¼šä¿æŒçª—å£å¤§å°ä¸º p.size()
            if (right-left == p.size()) {
                // å¦‚æœç§»å‡ºçš„æ˜¯ p ä¸­éœ€è¦çš„å­—ç¬¦ (cnt >= 0)ï¼Œåˆ™æœ‰æ•ˆå­—ç¬¦æ•° seed åŠ  1
                // æ³¨æ„ï¼šè¿™é‡Œæ˜¯å…ˆåˆ¤æ–­ >= 0ï¼Œå† ++ã€‚å› ä¸ºä¸Šé¢ -- æ“ä½œåï¼Œå¦‚æœæ˜¯å¤šä½™å­—ç¬¦ï¼Œcnt ä¼šå˜æˆè´Ÿæ•°ã€‚
                // åªæœ‰å½“ cnt >= 0 æ—¶ï¼Œè¯´æ˜å®ƒåŸæœ¬æ˜¯æ­£æ•°æˆ–0ï¼ˆå³å®ƒæ˜¯ p ä¸­çš„å­—ç¬¦ï¼Œä¸”æ²¡æœ‰è¿‡é‡åŒ¹é…ï¼‰ï¼Œ
                // ç§»é™¤å®ƒæ„å‘³ç€æˆ‘ä»¬éœ€è¦é‡æ–°åŒ¹é…è¿™ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥ seed++ã€‚
                if (cnt[s[left]-'a']++ >= 0) {
                    ++seed;
                }
                ++left;
            }
        }

        return ret;
    }
};

/**
 * --------------------------------------------------------------------------
 * ğŸ“ å­¦ä¹ ç¬”è®° & é”™è¯¯è®°å½• (Notes & Mistakes)
 * --------------------------------------------------------------------------
 * 
 * 1. æ ¸å¿ƒæ€è·¯ (æ»‘åŠ¨çª—å£ + è®¡æ•°æ•°ç»„):
 *    - é¢˜ç›®è¦æ±‚æ‰¾åˆ°æ‰€æœ‰å¼‚ä½è¯ï¼Œå¼‚ä½è¯çš„ç‰¹ç‚¹æ˜¯å­—ç¬¦ç§ç±»å’Œæ•°é‡ç›¸åŒï¼Œé¡ºåºæ— å…³ã€‚
 *    - ä½¿ç”¨ä¸€ä¸ªå›ºå®šå¤§å°ä¸º p.size() çš„æ»‘åŠ¨çª—å£åœ¨ s ä¸Šæ»‘åŠ¨ã€‚
 *    - ä¼˜åŒ–ç‚¹ï¼šä½¿ç”¨ä¸€ä¸ªé•¿åº¦ä¸º 26 çš„æ•°ç»„ `cnt` æ¥ç»Ÿè®¡å­—ç¬¦å·®å¼‚ï¼Œä»¥åŠä¸€ä¸ªæ•´æ•° `seed` æ¥è®°å½•â€œè¿˜éœ€è¦åŒ¹é…çš„å­—ç¬¦æ€»æ•°â€ã€‚
 * 
 * 2. å˜é‡è§£é‡Š:
 *    - `cnt`: åˆå§‹åŒ–ä¸º p ä¸­å­—ç¬¦çš„è®¡æ•°ã€‚
 *      - å½“ s[right] è¿›å…¥çª—å£ï¼Œ`cnt[s[right]]--`ã€‚
 *      - å½“ s[left] ç¦»å¼€çª—å£ï¼Œ`cnt[s[left]]++`ã€‚
 *      - æ­£æ•°è¡¨ç¤º p ä¸­æœ‰è¯¥å­—ç¬¦ä¸”çª—å£ä¸­è¿˜ç¼ºï¼›è´Ÿæ•°è¡¨ç¤ºçª—å£ä¸­è¯¥å­—ç¬¦å¤šä½™äº† p ä¸­çš„æ•°é‡ã€‚
 *    - `seed`: åˆå§‹åŒ–ä¸º p.size()ã€‚è¡¨ç¤º p ä¸­è¿˜æœ‰å¤šå°‘ä¸ªå­—ç¬¦æ²¡æœ‰åœ¨å½“å‰çª—å£ä¸­è¢«â€œæœ‰æ•ˆâ€åŒ¹é…ã€‚
 *      - å½“ `cnt[x] > 0` æ—¶å‡å° seedï¼Œè¡¨ç¤ºåŒ¹é…åˆ°äº†ä¸€ä¸ªæœ‰æ•ˆå­—ç¬¦ã€‚
 *      - å½“ `cnt[x] >= 0` æ—¶å¢åŠ  seedï¼Œè¡¨ç¤ºç§»å‡ºäº†ä¸€ä¸ªæœ‰æ•ˆå­—ç¬¦ã€‚
 * 
 * 3. å¤æ‚åº¦:
 *    - æ—¶é—´å¤æ‚åº¦ï¼šO(N)ï¼Œå…¶ä¸­ N æ˜¯ s çš„é•¿åº¦ã€‚æˆ‘ä»¬åªéå†äº†ä¸€é sã€‚
 *    - ç©ºé—´å¤æ‚åº¦ï¼šO(1)ï¼Œå› ä¸ºå­—ç¬¦é›†å¤§å°å›ºå®šä¸º 26ã€‚
 * 
 * --------------------------------------------------------------------------
 */

// è¾…åŠ©å‡½æ•°ï¼šæ‰“å° vector<int>
void printVector(const vector<int>& v) {
    cout << "[";
    for (int i = 0; i < v.size(); ++i) {
        cout << v[i] << (i < v.size() - 1 ? "," : "");
    }
    cout << "]";
}

// è¾…åŠ©å‡½æ•°ï¼šæ‰“å°æµ‹è¯•ç»“æœ
void printTest(string s, string p, const vector<int>& expected, Solution& solution) {
    cout << "Input: s = \"" << s << "\", p = \"" << p << "\"" << endl;
    
    vector<int> result = solution.findAnagrams(s, p);
    
    cout << "Output: ";
    printVector(result);
    cout << endl;
    
    cout << "Expected: ";
    printVector(expected);
    cout << endl;
    
    bool passed = (result == expected);
    cout << (passed ? "âœ… Passed" : "âŒ Failed") << endl;
    cout << "--------------------------------" << endl;
}

int main() {
    Solution solution;

    // ç¤ºä¾‹ 1
    printTest("cbaebabacd", "abc", {0, 6}, solution);

    // ç¤ºä¾‹ 2
    printTest("abab", "ab", {0, 1, 2}, solution);

    // é¢å¤–æµ‹è¯•ï¼šæ— åŒ¹é…
    printTest("hello", "world", {}, solution);

    // é¢å¤–æµ‹è¯•ï¼šå®Œå…¨åŒ¹é…
    printTest("abc", "abc", {0}, solution);

    return 0;
}